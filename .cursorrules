# 머나먼약속 (A Distant Promise) — Cursor Rules
# 전체 컨텍스트: AGENTS.md / docs/prd.md 참조

## 프로젝트 요약
모바일 RTS MVP. React 19 + Phaser 3.80 + TypeScript 5.6 (strict).
서버 없음. 싱글플레이어. 5유닛 오토 전투 + 스와이프 명령.

## 폴더 역할 (위반 금지)
- src/app/store/       → Zustand 슬라이스만
- src/app/ui/          → React 컴포넌트만
- src/game/            → Phaser 전용. React 파일 절대 금지
- src/types/index.ts   → 모든 타입 정의. 이 파일 외 타입 정의 금지

## 아키텍처 규칙
- React ↔ Phaser 통신은 반드시 EventBus(EventEmitter3) 경유
- React에서 Phaser 인스턴스 직접 접근 금지 (game.scene.getScene() 등)
- 상태관리는 Zustand만 사용 (Redux, Context API 금지)
- 인라인 타입 정의 금지 → types/index.ts에만 작성

## 코드 스타일
- TypeScript strict: true 유지. `any` 사용 절대 금지
- React 함수형 컴포넌트만 (클래스 컴포넌트 금지)
- 클래스와 중요 함수 위에 한글 주석 필수
- import 경로: 상대경로 사용, 절대경로(/assets/...) 금지
- asset 경로: import.meta.env.BASE_URL 기반

## 성능 규칙
- Phaser update() 루프 내 new 객체 생성 금지 → Object Pool 사용
- Graphics 객체는 값 변경 시에만 재드로우
- 목표: 10유닛 + 20발 투사체 → 60FPS (모바일 저사양 기준)

## 전투 모드
- 공격: 5~15분, 적 거점 점령 시 승리
- 방어: 10~15분, 아군 거점 수호 시 승리

## 핵심 타입 (types/index.ts)
- UnitData: id, type('infantry'|'tank'|'air'|'special'), tier(1~6), hp, attack, speed...
- PlayerData: resources, fame, rank('soldier'|'general'|'marquis'|'duke'), allUnits(24), deck(5)
- CapturePoint: id, x, y, owner('player'|'enemy'|'neutral'), hp
- BattleResult: result('win'|'lose'), mode('attack'|'defense'), survivalCount, timeElapsed, ...

## 금지 사항
- any 타입 사용
- Phaser 코드를 React 파일에 작성
- 클래스 컴포넌트 사용
- Redux / Context API 도입
- /assets/ 절대 경로 사용
- update() 루프 내 객체 new 생성

## AI 에셋 자동 생성
Claude, Cursor, Gemini 등 프로젝트 코드를 작성하는 AI는 플레이스홀더 텍스처(대충 만든 이미지)를 쓰지 않는다! 에셋이 필요할 때는 반드시 내장된 스크립트로 직접 생성해서 폴더에 그룹화하여 사용한다.
```bash
node scripts/generate_sprite.mjs "디테일한 영문 프롬프트" "폴더명/저장할파일명.jpeg"
```
* 필요: 프로젝트 루트 `.env` 파일에 `GEMINI_API_KEY` 설정
* 문서화 의무: 이미지가 특정 하위 폴더에 저장될 때마다, 반드시 **해당 폴더 내에 위치한 `README.md` 파일에도 추가/수정 내역(파일명과 목적)을 기록**해야 한다.
